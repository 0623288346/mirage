<section class="loading" *ngIf="!connected && !initial_connect">
	<div class="vertical-cell text-center">
		<h1>
			<i class="fa fa-spinner fa-spin fa-1x"></i>Please wait!
		</h1>
	</div>
</section>
<div class="app-container">
	<!-- HEADER START -->
	<form class="col-xs-12 init-ES" id="init-ES">
		<div class="esContainer">
			<div class="form-group m-0 col-xs-8 pd-0 pr-5">
				<input type="text"
					[(ngModel)]="config.url"
					class="form-control" 
					name="url" 
					placeholder="ElasticSearch Cluster URL: https://username:password@scalr.api.appbase.io" />
			</div>
			<div class="form-group m-0 col-xs-4 pd-0 pr-5">
				<input type="text" 
			[(ngModel)]="config.appname"
			class="form-control"
			name="appname" 
			placeholder="Index name to browse data from" value="moviedb" />
			</div>
			<div class="submit-btn-container">
				<a (click)="connect(true)" [class.btn-info] ="mapping != null" class="btn btn-default submit-btn">
					<span *ngIf = "!connected">Connect</span>
					<span *ngIf = "connected">Connected</span>
				</a>
			</div>
		</div>
	</form>
	<!-- HEADER END -->
	<div class="container-fluid">
		<div class="row feature-query-container" [ngClass]="{off: !sidebar}">
			<!-- Sidebar start -->
			<div class="features-section">
				<a (click)="sidebarToggle();" class="btn btn-default sidebar-toggle">
					<i class="fa fa-chevron-left sidebar-close"></i>
					<i class="fa fa-chevron-right sidebar-open"></i>
				</a>
				<div class="feature-section-container col-xs-12 pd-0">
					<list-query [savedQueryList]="savedQueryList" [sort_by]="sort_by" [sort_direction]="sort_direction" [searchTerm]="searchTerm" [filteredQuery]="filteredQuery" (newQuery)="newQuery($event);" (deleteQuery)="deleteQuery($event)" (clearAll)="clearAll($event);" (sort)="sort($event);" (searchList)="searchList($event);"></list-query>
				</div>
			</div>
			<!-- Sidebar end -->
			<!-- Query main container start -->
			<div class="col-xs-12 query-main-container" id="content">
				<div class="col-sm-12 col-md-6 query-build ui-layout-west" id="paneWest">
					<query-build [finalUrl]="finalUrl" [detectChange]="detectChange" [mapping]="mapping" [types]="types" [selectedTypes]="selectedTypes" [result]="result" [config]="config" [editorHookHelp]="editorHookHelp" [savedQueryList]="savedQueryList" [query_info]="query_info" (saveQuery)="saveQuery($event)" (setFinalUrl)="setFinalUrl($event)" [urlShare]="urlShare"></query-build>
				</div>
				<div class="col-sm-12 col-md-6 ui-layout-center"  id="paneCenter">
					<query-result  [mapping]="mapping" [types]="types" [selectedTypes]="selectedTypes" [result]="result" [config]="config" [editorHookHelp]="editorHookHelp" [responseHookHelp]="responseHookHelp" [finalUrl]="finalUrl"></query-result>
				</div>
			</div>
			<!-- Query main container end -->	
		</div>
		<div class="row">
			<div class="col-xs-12">
				<div class="row">
					<query-run  [mapping]="mapping" [types]="types" [selectedTypes]="selectedTypes" [result]="result" [config]="config" [responseHookHelp]="responseHookHelp"></query-run>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="saveQueryModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<form (ngSubmit)="saveQuery()" #heroForm="ngForm">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<h4 class="modal-title" id="myModalLabel">Save Query</h4>
				</div>
				<div class="modal-body">
					<div class="form-group">
						<label for="name">Name</label>
						<input type="text" class="form-control" required [(ngModel)]="query_info.name" ngControl="name" #name="ngForm" />
						<div [hidden]="name.valid || name.pristine" class="alert alert-danger">Name is required</div>
					</div>
					<div class="form-group">
						<label for="tag">Tag</label>
						<input type="text" class="form-control" [(ngModel)]="query_info.tag" ngControl="tag" #tag="ngForm" />
					</div>
				</div>
				<div class="modal-footer">
					<button type="submit" class="btn btn-default btn-primary" [disabled]="!heroForm.form.valid">Submit</button>
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				</div>
			</form>
		</div>
	</div>
</div>